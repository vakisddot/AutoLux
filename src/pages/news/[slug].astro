---
import { render } from "astro:content";
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import "../../styles/markdown.css"

export async function getStaticPaths() {
  const news = await getCollection("news");

  return news.map((entry) => {
    return {
      params: { slug: entry.data.slug },
      props: { entry },
    };
  });
}

const { entry } = Astro.props;
const { Content } = await render(entry);

const formattedDate = entry.data.pubDate.toLocaleDateString('bg-BG', {
    day: 'numeric',
    month: 'long',
    year: 'numeric'
});
---

<Layout title={entry.data.title}>
<section class="relative h-[60vh] min-h-[400px] w-full flex items-end">
    <img 
        src=`/news/${entry.data.slug}.jpg`
        alt={entry.data.title}
        class="absolute inset-0 w-full h-full object-cover z-0"
    />
    
    <div class="gradient"></div>

    <div class="container mx-auto px-12 relative z-20 pb-16">
        <div class="max-w-4xl">
            <div class="flex items-center gap-4 mb-4 text-sm font-medium">
                <span class="text-primary uppercase">{formattedDate}</span>
                <span class="text-white uppercase">От {entry.data.author}</span>
            </div>
            
            <h1 class="text-4xl md:text-5xl lg:text-6xl font-bold text-white mb-6 leading-tight">
                {entry.data.title}
            </h1>

            {entry.data.tags && (
                <div class="flex gap-2">
                    {entry.data.tags.map((tag: string) => (
                        <span class="px-3 py-1 border border-white/20 text-white/80 text-xs uppercase tracking-wider rounded-full backdrop-blur-sm">
                            {tag}
                        </span>
                    ))}
                </div>
            )}
        </div>
    </div>
</section>

<section class="bg-bg-primary pb-24">
    <div class="container mx-auto px-12">
        <div class="max-w-4xl">
            <div class="markdown">
                <Content  />
            </div>
            
            <div class="mt-16 pt-8 border-t border-white/10">
                <a href="/news/1" class="inline-flex items-center gap-2 text-white hover:text-primary transition-colors font-medium">
                    <i class="ph ph-arrow-left"></i> Обратно към новините
                </a>
            </div>
        </div>
    </div>
</section>
</Layout>